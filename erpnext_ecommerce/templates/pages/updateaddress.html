{% extends "templates/layout/customweb.html" %}
{% block loader %}
{% include "/templates/pages/defaultpageloader.html" %}
{% endblock %}
{% block content %}
<section class="dashboard pad-8">
   
        <div class="row">
            <div class="col-md-3 col-xs-12 col-sm-3 pad-right-5">

                {% include "templates/layout/sidebar.html" %}
            </div>
            <div class="col-md-9 col-xs-12 col-sm-9 content-data pad-left-5">
                   <div class="inner-card">
                <div class="pad-a">
                    {% if type=="new" %}
                        <h3 style="padding-left: 10px;">Add Address</h3>
                    {% else %}
                        <h3 style="padding-left: 10px;">Edit Address</h3>
                    {% endif %}
                    <a class="btn btn-primary add-btn" onclick="saveAddress()">Save</a>
                </div>
                <hr style="margin-bottom: 5px;">
                <div class="detail_box">
                    <div class="row">
                        {% if address %}
                        {% for item in address %}
                        <div class="col-md-12 col-sm-12 col-xs-12" data-name="{{item.name}}">
                            <div class="addr-box">
                                <div class="row">
                                <div class="col-md-6 col-sm-6 col-xs-12">
                                    <div class="field-set">
                                        <div class="caption-wraper"><label class="field_label">Address title<span class="mandatory">*</span></label></div>
                                        <div class="field-wraper">
                                            <div class="field_cover"><input data-field-caption="Name" type="text" name="address_title" id="address_title" value="{{item.address_title}}"></div>
                                        </div>
                                        <ul class="errorlist erlist_user_username" id="address_title-err">
                                            <li><a href="">Please enter address title</a></li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12">
                                    <div class="field-set">
                                        <div class="caption-wraper"><label class="field_label">Flat/House No, Building Number<span class="mandatory">*</span></label></div>
                                        <div class="field-wraper">
                                            <div class="field_cover"><input data-field-caption="Name" type="text" name="address" id="address" value="{{item.address_line1}}"></div>
                                        </div>
                                        <ul class="errorlist erlist_user_username" id="address-err">
                                            <li><a href="">Please enter Flat/House No, Building Number</a></li>
                                        </ul>
                                    </div>
                                </div>
                                </div>
                                <div class="row">
                                <div class="col-md-6 col-sm-6 col-xs-12">
                                    <div class="field-set">
                                        <div class="caption-wraper"><label class="field_label">Road No, Road Name, Block No<span class="mandatory">*</span></label></div>
                                        <div class="field-wraper">
                                            <div class="field_cover"><input data-field-caption="Name" type="text" name="address2" id="address2" value="{{item.address_line2}}"></div>
                                        </div>
                                        <ul class="errorlist erlist_user_username" id="address2-err">
                                            <li><a href="">Please enter Road No, Road Name, Block No</a></li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12">
                                    <div class="field-set">
                                        <div class="caption-wraper"><label class="field_label">Area<span class="mandatory">*</span></label></div>
                                        <div class="field-wraper">
                                            <div class="field_cover"><input data-field-caption="Name" type="text" name="city" id="city" value="{{item.city}}"></div>
                                        </div>
                                        <ul class="errorlist erlist_user_username" id="city-err">
                                            <li><a href="">Please enter Area</a></li>
                                        </ul>
                                    </div>
                                </div>
                                </div>
                                <div class="row">
                                <div class="col-md-6 col-sm-6 col-xs-12">
                                    <div class="field-set">
                                        <div class="caption-wraper"><label class="field_label">Governorate<span class="mandatory">*</span></label></div>
                                        <div class="field-wraper">
                                            <div class="field_cover"><input data-field-caption="Name" type="text" name="state" id="state" value="{{item.state}}"></div>
                                        </div>
                                        <ul class="errorlist erlist_user_username" id="state-err">
                                            <li><a href="">Please enter Governorate</a></li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12">
                                    <div class="field-set">
                                        <div class="caption-wraper"><label class="field_label">Country<span class="mandatory">*</span></label></div>
                                        <div class="field-wraper">
                                            <div class="field_cover">
                                                <select name="country" id="country">
                                                    <option value=""></option>
                                                    {% for countries in country %}
                                                    <option value="{{countries.name}}" {% if countries.name == item.country %}selected{% endif %}>{{countries.name}}</option>
                                                    {% endfor %}
                                                </select>
                                            </div>
                                        </div>
                                        <ul class="errorlist erlist_user_username" id="country-err">
                                            <li><a href="">Please select country</a></li>
                                        </ul>
                                    </div>
                                </div>
                                </div>
                                <!-- <div class="row">
                                <div class="col-md-6 col-sm-6 col-xs-12">
                                    <div class="field-set">
                                        <div class="caption-wraper"><label class="field_label">Zipcode<span class="mandatory">*</span></label></div>
                                        <div class="field-wraper">
                                            <div class="field_cover"><input data-field-caption="Name" type="text" name="zipcode" id="zipcode" value="{{item.pincode}}"></div>
                                        </div>
                                        <ul class="errorlist erlist_user_username" id="zipcode-err">
                                            <li><a href="">Please enter zipcode</a></li>
                                        </ul>
                                    </div>
                                </div>
                                </div> -->
                            </div>
                        </div>
                        {% endfor %}
                        {% else %}
                        <div class="col-md-12 col-sm-12 col-xs-12">
                            <div class="addr-box">
                                <div class="row">
                                <div class="col-md-6 col-sm-6 col-xs-12">
                                    <div class="field-set">
                                        <div class="caption-wraper"><label class="field_label">Address title<span class="mandatory">*</span></label></div>
                                        <div class="field-wraper">
                                            <div class="field_cover"><input data-field-caption="Name" type="text" name="address_title1" id="address_title1" value=""></div>
                                        </div>
                                        <ul class="errorlist erlist_user_username" id="address_title1-err">
                                            <li><a href="">Please enter address title</a></li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12">
                                    <div class="field-set">
                                        <div class="caption-wraper"><label class="field_label">Address Flat/House No, Building Number<span class="mandatory">*</span></label></div>
                                        <div class="field-wraper">
                                            <div class="field_cover"><input data-field-caption="Name" type="text" name="address1" id="address1" value=""></div>
                                        </div>
                                        <ul class="errorlist erlist_user_username" id="address1-err">
                                            <li><a href="">Please enter address Flat/House No, Building Number</a></li>
                                        </ul>
                                    </div>
                                </div>
                                </div>
                                <div class="row">
                                <div class="col-md-6 col-sm-6 col-xs-12">
                                    <div class="field-set">
                                        <div class="caption-wraper"><label class="field_label">Road No, Road Name, Block No<span class="mandatory">*</span></label></div>
                                        <div class="field-wraper">
                                            <div class="field_cover"><input data-field-caption="Name" type="text" name="address21" id="address21" value=""></div>
                                        </div>
                                        <ul class="errorlist erlist_user_username" id="address21-err">
                                            <li><a href="">Please enter Road No, Road Name, Block No</a></li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12">
                                    <div class="field-set">
                                        <div class="caption-wraper"><label class="field_label">Area<span class="mandatory">*</span></label></div>
                                        <div class="field-wraper">
                                            <div class="field_cover"><input data-field-caption="Name" type="text" name="city1" id="city1" value=""></div>
                                        </div>
                                        <ul class="errorlist erlist_user_username" id="city1-err">
                                            <li><a href="">Please enter Area</a></li>
                                        </ul>
                                    </div>
                                </div>
                                </div>
                                <div class="row">
                                <div class="col-md-6 col-sm-6 col-xs-12">
                                    <div class="field-set">
                                        <div class="caption-wraper"><label class="field_label">Governorate<span class="mandatory">*</span></label></div>
                                        <div class="field-wraper">
                                            <div class="field_cover"><input data-field-caption="Name" type="text" name="state1" id="state1" value=""></div>
                                        </div>
                                        <ul class="errorlist erlist_user_username" id="state1-err">
                                            <li><a href="">Please enter Governorate</a></li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12">
                                    <div class="field-set">
                                        <div class="caption-wraper"><label class="field_label">Country<span class="mandatory">*</span></label></div>
                                        <div class="field-wraper">
                                            <div class="field_cover">
                                                <select name="country1" id="country1">
                                                    <option value=""></option>
                                                    {% for countries in country %}
                                                    <option value="{{countries.name}}"  {% if countries.name == default_country %}selected{% endif %}>{{countries.name}}</option>
                                                    {% endfor %}
                                                </select>
                                            </div>
                                        </div>
                                        <ul class="errorlist erlist_user_username" id="country1-err">
                                            <li><a href="">Please select country</a></li>
                                        </ul>
                                    </div>
                                </div>
                                </div>
                                <!-- <div class="row">
                                <div class="col-md-6 col-sm-6 col-xs-12">
                                    <div class="field-set">
                                        <div class="caption-wraper"><label class="field_label">Zipcode<span class="mandatory">*</span></label></div>
                                        <div class="field-wraper">
                                            <div class="field_cover"><input data-field-caption="Name" type="text" name="zipcode1" id="zipcode1" value=""></div>
                                        </div>
                                        <ul class="errorlist erlist_user_username" id="zipcode1-err">
                                            <li><a href="">Please enter zipcode</a></li>
                                        </ul>
                                    </div>
                                </div>
                                </div> -->
                            </div>
                        </div>
                        {% endif %}
                    
                </div>
                   </div>
            </div>
        </div>
    </div>
   
</section>
<style type="text/css">
.list-contain-a {
    font-size: 18px !important;
}
.pad-a{
    padding: 0 10px;
}
.pad-left-5{
    padding-left: 5px;
}   
.pad-right-5{
    padding-right: 5px;
}
.inner-card{
    display: block;
    background: #fff;
    padding: 0px;
    padding-bottom: 0px;
    border: 1px solid #dedfe3 !important;
    /* padding-bottom: 15px; */
    border-radius: 2px;
    box-shadow: 0 2px 4px 0 rgba(0,0,0,.08);
    margin-bottom: 25px;
}
.dashboard .profile-menu{
    margin-top: 11px;
}
.mar-8{
    margin: 8px; 
}

.table tbody tr td {
    border-top: 0;
}

.list-box {
    padding: 10px;
}

.box-style {
    margin-right: 0;
    margin-left: 0;
    border: 1px solid #ddd;
    background: #e6e3e3;
}

/*.btn {
    margin-top: 30px;
}
*/
.detail_box {
    /*background: #f5f5f5;*/
    /*float: left;*/
    width: 100%;
    /*padding-top: 70px;*/
    padding-bottom: 50px;
    /*margin-top: 15px;*/
}

.detail_box .box_item {
    width: 600px;
    background: #fff;
    text-align: left;
}

.detail_box .box_item1 {
    padding: 48px;
}

.detail_box .table_design {
    margin-top: 15px;
    border-collapse: collapse;
    background: #fff;
    color: #737373;
}

.table_design .title {
    color: #915048;
    font-size: 18px;
    font-weight: bold;
}

.table_design .txt_design {
    font-size: 15px;
    margin-top: 10px;
    margin-bottom: 5px;
    float: left;
}

.table_design .td_style {
    font-weight: bold;
    border-left: 1px solid #c3c3c3;
    border-bottom: 1px solid #c3c3c3;
    border-top: 1px solid #c3c3c3;
    padding: 10px !important;
}

.addr-box {
    /*border: 1px solid #ddd;*/
    padding: 10px 15px;
    background: #fff;
    color: #000;
    margin-top: 10px;
    min-height: 180px;
}

.addr-title {
    font-size: 18px;
    font-weight: 500;
    margin-bottom: 10px;
}

.options {
   background: #fff;
    border: 1px solid #ddd;
    border-top: 0;
    padding: 10px;
    padding-left: 5px;
    border-left: 1px solid #ddd;
}

.options a {
    color: #000;
       padding: 10px 15px;
}

.options .edit:hover {
    color: white;
    background: #7da435;
}
.options .edit
{
    color: white;
    background: #7da435;
}
.options .delete:hover {
    color: #fff;
    background: #ab3c2d;
    cursor: pointer;
}
.options .delete
{
   color: #fff;
    background: #ab3c2d;
    cursor: pointer;
}
.add-btn{
   position: absolute;
    top: 10px;
    /*top: 7%;*/
    right: 30px;
}

.field-set {
    width: 100%;
    display: inline-block;
    margin: 0 0 20px;
}

.field_label {
    font-weight: normal !important;
}

.errorlist {
    display: none;
}

.errorlist {
    margin: 0;
    list-style: none;
    padding: 2px 10px 4px;
    position: relative;
    background: #fdf7f6;
    clear: both;
    display: none;
}

.errorlist li {
    font-size: 12px;
    position: relative;
}

.errorlist li:last-child {
    padding-bottom: 0;
}

.errorlist li a {
    color: #f44336;
    font-size: 11px;
    text-decoration: none;
}

input[type="text"], input[type="email"], input[type="phone"], input[type="search"], input[type="password"], textarea, select, input[type="number"], input[type="file"] {
    background-color: #fff;
    border: 1px solid #dcdcdc;
    height: 40px;
    padding: 0 10px;
    width: 100%;
    color: var(--txt-color);
    font-family: inherit;
    font-size: 1em;
    font-weight: normal;
    border-radius: 2px;
}
.form input[type="submit"], .form input[type="button"] {
    position: relative;
    display: inline-block;
    box-sizing: border-box;
    margin: 0 10px;
    border: none;
    border-radius: 2px;
    padding: 0 40px;
    height: 40px;
    vertical-align: middle;
    text-align: center;
    text-overflow: ellipsis;
    color: #fff;
    background: #ee9B00;
    box-shadow: 0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12);
    font-size: 1em;
    font-weight: 500;
    line-height: 40px;
    overflow: hidden;
    outline: none;
    cursor: pointer;
    -webkit-transition: -webkit-box-shadow 0.2s;
    transition: -webkit-box-shadow 0.2s;
    transition: box-shadow 0.2s;
    transition: box-shadow 0.2s, -webkit-box-shadow 0.2s;
}

@media screen and (min-width: 992px){
    .page-section {
        margin: 0px auto;
        max-width: 1366px;
        padding: 14px 64px 14px !important;
    }
}
@media screen and (max-width: 767px) and (min-width: 320px) {
    .detail_box .box_item {
        width: auto;
    }

    .detail_box .box_item1 {
        padding: 20px;
    }

    .table_design .txt_design {
        font-size: 13px;
    }

    .table_design .title {
        font-size: 17px;
    }
    
    .float-right{
            float: none;
    }
   .add-btn {
    right: 5px;
    position: relative;
    float: right;
    margin-top: 10px;
}
    .pad-left-5{
            padding-left: 15px !important;
            padding-right: 15px;
    }
}
</style>
{% endblock %}
{% block script %}
<script type="text/javascript">
function saveAddress(e) {
    var formData = {};
    var url ='';
    if("{{type}}" == "new"){
        formData.addr1 = $('#address1').val();
        formData.addr2 = $('#address21').val();
        formData.city = $('#city1').val();
        formData.state = $('#state1').val();
        formData.country = $('#country1').val();
        // formData.pincode = $('#zipcode1').val();
        // formData.addrtype = $('#address_title1').val();
        formData.addrtitle = $('#address_title1').val();
        var links = [];
        var link = {};
        link.link_doctype = "Customer";
        link.link_name = "{{customer_id}}"
        links.push(link)
        formData.links = links;
        url = '/api/method/erpnext_ecommerce.erpnext_ecommerce.api.insert_address'
    }else{
        formData.addr1 = $('#address').val();
        formData.addr2 = $('#address2').val();
        formData.city = $('#city').val();
        formData.state = $('#state').val();
        formData.country = $('#country').val();
        // formData.pincode = $('#zipcode').val();
        // formData.addrtype = $('#address_title').val();
        formData.addrtitle = $('#address_title').val();
        formData.name = "{{name}}"
        url = '/api/method/erpnext_ecommerce.erpnext_ecommerce.api.edit_address'
    }
    
    if (formData.addr1 != '' && formData.addr2 != '' & formData.city != '' && formData.country != '' && formData.state != ''&& formData.addrtitle != '') {
        $.ajax({
            type: 'POST',
            Accept: 'application/json',
            ContentType: 'application/json;charset=utf-8',
            url: window.location.origin + url,
            dataType: "json",
            data: { 'data': JSON.stringify(formData) },
            async: false,
            headers: {
                'X-Frappe-CSRF-Token': '{{csrf_token}}'
            },
            success: function(data) {
                if (data.message) {
                    window.location.href = window.location.origin +'/my-address';
                }
            },
            error: function(xhr, text, data) {
                var html = xhr.responseJSON.message;
            }
        })
    } else {
        if("{{type}}" == "new"){
            if (formData.addr1 == '')
                $('#address1-err').show();
            else
                $('#address1-err').hide();
            if (formData.addr2 == '')
                $('#address21-err').show();
            else
                $('#address21-err').hide();
            if (formData.city == '')
                $('#city1-err').show();
            else
                $('#city1-err').hide();
            if (formData.country == '')
                $('#country1-err').show();
            else
                $('#country1-err').hide();
            if (formData.state == '')
                $('#state1-err').show();
            else
                $('#state1-err').hide();
            // if (formData.pincode == '')
            //     $('#zipcode1-err').show();
            // else
            //     $('#zipcode1-err').hide();
            if (formData.addrtitle == '')
                $('#address_title1-err').show();
            else
                $('#address_title1-err').hide();
        }else{
            if (formData.addr1 == '')
                $('#address-err').show();
            else
                $('#address-err').hide();
            if (formData.addr2 == '')
                $('#address2-err').show();
            else
                $('#address2-err').hide();
            if (formData.city == '')
                $('#city-err').show();
            else
                $('#city-err').hide();
            if (formData.country == '')
                $('#country-err').show();
            else
                $('#country-err').hide();
            if (formData.state == '')
                $('#state-err').show();
            else
                $('#state-err').hide();
            // if (formData.pincode == '')
            //     $('#zipcode-err').show();
            // else
            //     $('#zipcode-err').hide();
            if (formData.addrtype == '')
                $('#address_title-err').show();
            else
                $('#address_title-err').hide();
        }
    }
}

</script>
{% endblock %}