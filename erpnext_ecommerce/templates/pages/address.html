{% extends "templates/layout/customweb.html" %}
{% block loader %}
{% include "/templates/pages/defaultpageloader.html" %}
{% endblock %}
{% block content %}
<section class="dashboard pad-8">
   
        <div class="row">
            <div class="col-md-3 col-xs-12 col-sm-3 pad-right-5">

                {% include "templates/layout/sidebar.html" %}
            </div>
            <div class="col-md-9 col-xs-12 col-sm-9 content-data pad-left-5">
                   <div class="inner-card">
                <div class="pad-a">
                    <h3 style="padding-left: 10px;">Manage Addresses</h3>
                    <!-- <a href="/update-address?new=1" class="btn btn-primary add-btn"><span class="lnr lnr-plus-circle"></span> Add New</a> -->
                    <a href="/updateaddress?token=new" class="btn btn-primary add-btn"><span class="lnr lnr-plus-circle"></span> Add New</a>
                </div>
                <hr style="margin-bottom: 5px;">
                <div class="detail_box">
                    <div class="row">
                        <div class="col-md-12 col-xs-12 col-sm-12">
                            {% if address %}
                            {% for item in address %}
                            <div class="col-md-6 col-sm-6 col-xs-12" data-name="{{item.name}}">
                                <div class="addr-box">
                                    <div class="addr-title">{{item.address_title}}</div>
                                    <div>
                                        {{item.address_line1}},
                                        <br>
                                        {% if item.address_line2 %}{{item.address_line2}},<br>{% endif %}
                                        {{item.city}},<br>
                                         {% if item.state %}{{item.state}},{% endif %} {% if item.pincode %}{{item.pincode}},{% endif %}<br>
                                        {{item.country}}.
                                    </div>
                                </div>
                                <div class="options">
                                    <!-- <a href="/update-address?name={{item.name}}" class="edit"><span class="fa fa-edit"></span> Edit</a> -->
                                    <a href="/updateaddress?token={{item.name}}" class="edit"><span class="fa fa-edit"></span> Edit</a>
                                    <a class="delete" data-id="{{item.name}}" onclick="deleteAddress(this)"><span class="fa fa-trash"></span> Delete</a>
                                </div>
                            </div>
                            {% endfor %}
                            {% else %}
                            {% endif %}
                        </div>
                    </div>
                </div>
                   </div>
            </div>
   
</section>
<style type="text/css">
.list-contain-a {
    font-size: 18px !important;
}
.pad-a{
    padding: 0 10px;
}
.pad-left-5{
    padding-left: 5px;
}   
.pad-right-5{
    padding-right: 5px;
}
.inner-card{
    display: block;
    background: #fff;
    padding: 0px;
    padding-bottom: 0px;
    border: 1px solid #dedfe3 !important;
    /* padding-bottom: 15px; */
    border-radius: 2px;
    box-shadow: 0 2px 4px 0 rgba(0,0,0,.08);
    margin-bottom: 25px;
}
.dashboard .profile-menu{
    margin-top: 11px;
}
.mar-8{
    margin: 8px; 
}

.table tbody tr td {
    border-top: 0;
}

.list-box {
    padding: 10px;
}

.box-style {
    margin-right: 0;
    margin-left: 0;
    border: 1px solid #ddd;
    background: #e6e3e3;
}

/*.btn {
    margin-top: 30px;
}
*/
.detail_box {
    /*background: #f5f5f5;*/
    /*float: left;*/
    width: 100%;
    /*padding-top: 70px;*/
    padding-bottom: 50px;
    /*margin-top: 15px;*/
}

.detail_box .box_item {
    width: 600px;
    background: #fff;
    text-align: left;
}

.detail_box .box_item1 {
    padding: 48px;
}

.detail_box .table_design {
    margin-top: 15px;
    border-collapse: collapse;
    background: #fff;
    color: #737373;
}

.table_design .title {
    color: #915048;
    font-size: 18px;
    font-weight: bold;
}

.table_design .txt_design {
    font-size: 15px;
    margin-top: 10px;
    margin-bottom: 5px;
    float: left;
}

.table_design .td_style {
    font-weight: bold;
    border-left: 1px solid #c3c3c3;
    border-bottom: 1px solid #c3c3c3;
    border-top: 1px solid #c3c3c3;
    padding: 10px !important;
}

.addr-box {
    border: 1px solid #ddd;
    padding: 10px 15px;
    background: #fff;
    color: #000;
    margin-top: 10px;
    min-height: 180px;
}

.addr-title {
    font-size: 18px;
    font-weight: 500;
    margin-bottom: 10px;
}

.options {
   background: #fff;
    border: 1px solid #ddd;
    border-top: 0;
    padding: 10px;
    padding-left: 5px;
    border-left: 1px solid #ddd;
}

.options a {
    color: #000;
       padding: 10px 15px;
}

.options .edit:hover {
    color: white;
    background: #7da435;
}
.options .edit
{
    color: white;
    background: #7da435;
}
.options .delete:hover {
    color: #fff;
    background: #ab3c2d;
    cursor: pointer;
}
.options .delete
{
   color: #fff;
    background: #ab3c2d;
    cursor: pointer;
}
.add-btn{
   position: absolute;
    top: 10px;
    /*top: 7%;*/
    right: 30px;
}
@media screen and (min-width: 992px){
    .page-section {
        margin: 0px auto;
        max-width: 1366px;
        padding: 14px 64px 14px !important;
    }
}
@media screen and (max-width: 767px) and (min-width: 320px) {
    .detail_box .box_item {
        width: auto;
    }

    .detail_box .box_item1 {
        padding: 20px;
    }

    .table_design .txt_design {
        font-size: 13px;
    }

    .table_design .title {
        font-size: 17px;
    }
    
    .float-right{
            float: none;
    }
   .add-btn {
    right: 5px;
    position: relative;
    float: right;
    margin-top: 10px;
}
    .pad-left-5{
            padding-left: 15px !important;
            padding-right: 15px;
    }
}
</style>
{% endblock %}
{% block script %}
<script type="text/javascript">
function deleteAddress(e) {
    var addrId = $(e).attr('data-id');
    $('#message_modal .modal-title').text('Confirm')
    var html = '<div>Do you really want to delete this address?</div><div style="text-align: right;"><button class="btn btn-default" data-dismiss="modal" style="margin-right: 10px;">Cancel</button><button class="btn btn-warning" data-id="' + addrId + '" onclick="deleteAddr(this)">Confirm</button></div>'
    $('#message_modal .modal-body').html(html)
    $('#message_modal').modal('show')
}

function deleteAddr(e) {
    var addrId = $(e).attr('data-id');
    $.ajax({
        type: 'POST',
        Accept: 'application/json',
        ContentType: 'application/json;charset=utf-8',
        url: window.location.origin + '/api/method/erpnext_ecommerce.erpnext_ecommerce.api.delete_address',
        data: { 'id': addrId },
        dataType: "json",
        async: false,
        headers:{
            'X-Frappe-CSRF-Token':'{{csrf_token}}'
        },
        success: function(data) {
            // $('#message_modal').modal('hide')
            $('div[data-name="' + addrId + '"]').remove();
            $('#message_modal .modal-title').text('Success')
            $('#message_modal .modal-body').html('Address have been deleted successfully!')
            // $('#message_modal').modal('show')
        }
    })
}
$(document).ready(function(){
	// frappe.call({
	// 	method:'salespurchase.sales_and_purchase.api.get_geodistance',
	// 	args:{
	// 		source:'13.0268923, 80.1709872',
	// 		destination:['13.0194904, 80.1694432','13.0178996, 80.17505']
	// 	},
	// 	callback:function(data){
	// 		console.log(data.message)
	// 	}
	// })
})
// dest lat:13.0258366, lng:80.1473151
// source lat:13.016247, lng:80.142093
</script>
{% endblock %}